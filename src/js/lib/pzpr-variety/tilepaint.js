/*! @license pzpr.js v3.6.0-pre (c) 2009-2016 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.classmgr.makeCustom(["tilepaint"],{MouseEvent:{use:!0,mouseinput:function(){this.puzzle.playmode?(this.mousestart||this.mousemove)&&this.inputtile():this.puzzle.editmode&&(this.btn.Left?(this.mousestart||this.mousemove)&&this.inputborder():this.btn.Right&&(this.mousestart||this.mousemove)&&this.inputBGcolor1(),this.mouseend&&this.notInputted()&&this.input51())},inputBGcolor1:function(){var a=this.getcell();a.isnull||a===this.mouseCell||a.is51cell()||(null===this.inputData&&(this.inputData=0===a.qsub?3:0),a.setQsub(this.inputData),this.mouseCell=a,a.draw())}},KeyEvent:{enablemake:!0,keyinput:function(a){this.inputnumber51(a,{2:this.board.cols-(this.cursor.bx>>1)-1,4:this.board.rows-(this.cursor.by>>1)-1})}},Cell:{qnum:0,qnum2:0,disInputHatena:!0,numberRemainsUnshaded:!0,minnum:0,subclear:function(){1===this.qsub&&(this.addOpe("qsub",1,0),this.qsub=0),this.error=0},set51cell:function(){this.setQues(51),this.setQnum(0),this.setQnum2(0),this.clrShade(),this.setQsub(0),this.set51aroundborder()},remove51cell:function(){this.setQues(0),this.setQnum(0),this.setQnum2(0),this.clrShade(),this.setQsub(0)},set51aroundborder:function(){for(var a=this.getdir4cblist(),b=0;b<a.length;b++){var c=a[b][0],d=a[b][1];d.isnull||d.setQues(this.is51cell()^c.is51cell()?1:0)}}},EXCell:{ques:51,qnum:0,qnum2:0,minnum:0},Board:{hasborder:1,hasexcell:1},BoardExec:{adjustBoardData:function(a,b){this.adjustQues51_1(a,b)},adjustBoardData2:function(a,b){this.adjustQues51_2(a,b)}},AreaRoomGraph:{enabled:!0,isnodevalid:function(a){return!a.is51cell()}},Graphic:{gridcolor_type:"LIGHT",bcolor_type:"GREEN",bbcolor:"rgb(127, 127, 127)",bgcellcolor_func:"qsub3",paint:function(){this.drawBGCells(),this.drawBGEXcells(),this.drawQues51(),this.drawGrid(),this.drawShadedCells(),this.drawBorders(),this.drawBoxBorders(!0),this.drawChassis_ex1(!0),this.drawNumbersOn51(),this.drawTarget()}},Encode:{decodePzpr:function(a){this.decodeBorder(),this.decodeTilePaint()},encodePzpr:function(a){this.encodeBorder(),this.encodeTilePaint()},decodeTilePaint:function(){var a=0,b=0,c=this.outbstr,d=this.board;d.disableInfo();for(var e=0;e<c.length;e++){var f=c.charAt(e),g=d.cell[a];if(f>="g"&&"z">=f?a+=parseInt(f,36)-16:(g.set51cell(),"-"===f?(g.qnum2="."!==c.charAt(e+1)?parseInt(c.charAt(e+1),16):-1,g.qnum=parseInt(c.substr(e+2,2),16),e+=3):"+"===f?(g.qnum2=parseInt(c.substr(e+1,2),16),g.qnum="."!==c.charAt(e+3)?parseInt(c.charAt(e+3),16):-1,e+=3):"="===f?(g.qnum2=parseInt(c.substr(e+1,2),16),g.qnum=parseInt(c.substr(e+3,2),16),e+=4):(g.qnum2="."!==c.charAt(e)?parseInt(c.charAt(e),16):-1,g.qnum="."!==c.charAt(e+1)?parseInt(c.charAt(e+1),16):-1,e+=1)),a++,!d.cell[a]){b=e+1;break}}d.enableInfo(),a=0;for(var e=b;e<c.length;e++){var f=c.charAt(e),h=d.excell[a];if("."===f?h.qnum2=-1:"-"===f?(h.qnum2=parseInt(c.substr(e+1,1),16),e+=2):h.qnum2=parseInt(f,16),a++,a>=d.cols){b=e+1;break}}for(var e=b;e<c.length;e++){var f=c.charAt(e),h=d.excell[a];if("."===f?h.qnum=-1:"-"===f?(h.qnum=parseInt(c.substr(e+1,2),16),e+=2):h.qnum=parseInt(f,16),a++,a>=d.cols+d.rows){b=e+1;break}}this.outbstr=c.substr(b)},encodeTilePaint:function(a){for(var b="",c=this.board,d=0,e=0;e<c.cell.length;e++){var f="",g=c.cell[e];51===g.ques?(f+=g.qnum2.toString(16),f+=g.qnum.toString(16),g.qnum>=16&&g.qnum2>=16?f="="+f:g.qnum>=16?f="-"+f:g.qnum2>=16&&(f="+"+f)):d++,0===d?b+=f:(f||20===d)&&(b+=(d+15).toString(36)+f,d=0)}d>0&&(b+=(d+15).toString(36));for(var e=0;e<c.cols;e++){var h=c.excell[e].qnum2;0>h?b+=".":16>h?b+=h.toString(16):256>h&&(b+="-"+h.toString(16))}for(var e=c.cols;e<c.cols+c.rows;e++){var h=c.excell[e].qnum;0>h?b+=".":16>h?b+=h.toString(16):256>h&&(b+="-"+h.toString(16))}this.outbstr+=b}},FileIO:{decodeData:function(){this.decodeAreaRoom(),this.decodeCellQnum51(),this.decodeCell(function(a,b){"#"===b?a.qans=1:"+"===b?a.qsub=1:"-"===b&&(a.qsub=3)})},encodeData:function(){this.encodeAreaRoom(),this.encodeCellQnum51(),this.encodeCell(function(a){return 1===a.qans?"# ":1===a.qsub?"+ ":3===a.qsub?"- ":". "})}},AnsCheck:{checklist:["checkSameColorTile","checkRowsColsShadeCell"],checkRowsColsShadeCell:function(){this.checkRowsColsPartly(this.isShadeCount,function(a){return a.is51cell()},"asShadeNe")},isShadeCount:function(a,b){var c=b.key51num,d=a.filter(function(a){return a.isShade()}).length,e=0>c||d===c;return e||(b.keycell.seterr(1),a.seterr(1)),e}},FailCode:{asShadeNe:["数字の下か右にある黒マスの数が間違っています。","The number of shaded cells underward or rightward is not correct."]}});