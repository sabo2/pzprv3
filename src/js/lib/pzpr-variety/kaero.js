/*! @license pzpr.js v3.6.0-pre (c) 2009-2016 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.classmgr.makeCustom(["kaero"],{MouseEvent:{mouseinput:function(){this.puzzle.playmode?this.mousestart||this.mousemove?this.btn.Left?this.inputMoveLine():this.btn.Right&&this.inputpeke():this.mouseend&&this.notInputted()&&this.inputlight():this.puzzle.editmode&&(this.mousestart||this.mousemove?this.inputborder():this.mouseend&&this.notInputted()&&this.inputqnum())},inputlight:function(){var a=this.getcell();a.isnull||(0===a.qsub?a.setQsub(this.btn.Left?1:2):1===a.qsub?a.setQsub(this.btn.Left?2:0):2===a.qsub&&a.setQsub(this.btn.Left?0:1),a.draw())}},KeyEvent:{enablemake:!0,key_inputqnum_main:function(a,b){return this.key_inputqnum_main_kaero(a,b)},key_inputqnum_main_kaero:function(a,b){if(b.length>1&&"BS"!==b)return!1;if(b>="a"&&"z">=b){var c=parseInt(b,36)-10,d=a.qnum;(d-1)%26===c&&d>0&&26>=d?a.setQnum(d+26):(d-1)%26===c?a.setQnum(-1):a.setQnum(c+1)}else if("-"===b)a.setQnum(-2!==a.qnum?-2:-1);else if("BS"===b)a.setQnum(a.qnum>=0?-2:-1);else{if(" "!==b)return!1;a.setQnum(-1)}return!0}},Cell:{maxnum:52},CellList:{getDeparture:function(){return this.map(function(a){return a.base}).notnull()}},Board:{cols:6,rows:6,hasborder:1},LineGraph:{enabled:!0,moveline:!0},AreaRoomGraph:{enabled:!0},Graphic:{gridcolor_type:"LIGHT",bgcellcolor_func:"qsub2",qsubcolor1:"rgb(224, 224, 255)",qsubcolor2:"rgb(255, 255, 144)",paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawBorders(),this.drawTip(),this.drawPekes(),this.drawDepartures(),this.drawLines(),this.drawCellSquare(),this.drawNumbers_kaero(),this.drawChassis(),this.drawTarget()},drawCellSquare:function(){for(var a=this.vinc("cell_number_base","crispEdges",!0),b=.7*this.bw-1,c=.7*this.bh-1,d=this.puzzle.execConfig("dispmove"),e=this.range.cells,f=0;f<e.length;f++){var g=e[f];a.vid="c_sq_"+g.id,!d&&g.isDeparture()||d&&g.isDestination()?(1===g.error?a.fillStyle=this.errbcolor1:1===g.qsub?a.fillStyle=this.qsubcolor1:2===g.qsub?a.fillStyle=this.qsubcolor2:a.fillStyle="white",a.fillRectCenter(g.bx*this.bw,g.by*this.bh,b,c)):a.vhide()}},drawNumbers_kaero:function(){for(var a=this.vinc("cell_number","auto"),b=this.puzzle.execConfig("dispmove"),c={ratio:[.85]},d=this.range.cells,e=0;e<d.length;e++){var f=d[e],g=f.bx*this.bw,h=f.by*this.bh,i=(b?f.base:f).qnum,j="";a.vid="cell_text_"+f.id,-1!==i?(-2===i?j="?":j+=i>0&&26>=i?(i+9).toString(36).toUpperCase():i>26&&52>=i?(i-17).toString(36).toLowerCase():i,a.fillStyle=this.getCellNumberColor(f),this.disptext(j,g,h,c)):a.vhide()}}},Encode:{decodePzpr:function(a){this.decodeBorder(),this.decodeKaero()},encodePzpr:function(a){this.encodeBorder(),this.encodeKaero()},decodeKaero:function(){for(var a=0,b=0,c=this.outbstr,d=this.board,e=0;e<c.length;e++){var f=c.charAt(e),g=d.cell[a];if(this.include(f,"0","9")?g.qnum=parseInt(f,36)+27:this.include(f,"A","Z")?g.qnum=parseInt(f,36)-9:"-"===f?(g.qnum=parseInt(c.charAt(e+1),36)+37,e++):"."===f?g.qnum=-2:this.include(f,"a","z")&&(a+=parseInt(f,36)-10),a++,!d.cell[a]){b=e+1;break}}this.outbstr=c.substring(b)},encodeKaero:function(){for(var a="",b=0,c=this.board,d=0;d<c.cell.length;d++){var e="",f=c.cell[d].qnum;-2===f?e=".":f>=1&&26>=f?e=""+(f+9).toString(36).toUpperCase():f>=27&&36>=f?e=""+(f-27).toString(10):f>=37&&72>=f?e="-"+(f-37).toString(36).toUpperCase():b++,0===b?a+=e:(e||26===b)&&(a+=(9+b).toString(36).toLowerCase()+e,b=0)}b>0&&(a+=(9+b).toString(36).toLowerCase()),this.outbstr+=a}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeCellQanssub(),this.decodeBorderQues(),this.decodeBorderLine()},encodeData:function(){this.encodeCellQnum(),this.encodeCellQanssub(),this.encodeBorderQues(),this.encodeBorderLine()}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine","checkConnectObject","checkLineOverLetter","checkSameObjectInRoom_kaero","checkGatheredObject","checkNoObjectBlock","checkDisconnectLine"],checkSameObjectInRoom_kaero:function(){var a=this.board.roommgr.components;a:for(var b=0;b<a.length;b++)for(var c=a[b].clist,d=-1,e=c.getDeparture(),f=0;f<e.length;f++){var g=e[f].qnum;if(-1===d)d=g;else if(d!==g){if(this.failcode.add("bkPlNum"),this.checkOnly)break a;this.puzzle.execConfig("dispmove")||e.seterr(4),c.seterr(1)}}},checkGatheredObject:function(){for(var a=0,b=this.board,c=0;c<b.cell.length;c++){var d=b.cell[c].base.qnum;d>a&&(a=d)}a:for(var d=0;a>=d;d++)for(var e=b.cell.filter(function(a){return d===a.base.qnum}),f=null,g=0;g<e.length;g++){var h=e[g].room;if(null===f)f=h;else if(null!==h&&f!==h){this.failcode.add("bkSepNum"),this.puzzle.execConfig("dispmove")||e.getDeparture().seterr(4),e.seterr(1);break a}}},checkNoObjectBlock:function(){this.checkNoMovedObjectInRoom(this.board.roommgr)}},FailCode:{bkNoNum:["アルファベットのないブロックがあります。","A block has no letters."],bkPlNum:["１つのブロックに異なるアルファベットが入っています。","A block has plural kinds of letters."],bkSepNum:["同じアルファベットが異なるブロックに入っています。","Same kinds of letters are placed different blocks."]}});