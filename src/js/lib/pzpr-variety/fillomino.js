/*! @license pzpr.js v3.6.0-pre (c) 2009-2016 sabo2, MIT license
 *   https://bitbucket.org/sabo2/pzprv3 */
pzpr.classmgr.makeCustom(["fillomino"],{MouseEvent:{mouseinput:function(){this.puzzle.playmode&&(this.mousestart||this.mousemove)&&(this.btn.Left?this.isBorderMode()?this.inputborder():this.dragnumber_fillomino():this.btn.Right&&this.inputQsubLine()),this.mouseend&&this.notInputted()&&(this.mouseCell=this.board.emptycell,this.inputqnum())},dragnumber_fillomino:function(){var a=this.getcell();if(!a.isnull&&a!==this.mouseCell){if(null===this.inputData)return this.inputData=a.getNum(),-1===this.inputData&&(this.inputData=-2),void(this.mouseCell=a);if(-2===this.inputData&&(this.inputData=-1===a.getNum()?-3:-1),this.inputData>=-1)a.setAnum(this.inputData),a.draw();else if(this.inputData<=-3){var b=this.mouseCell,c=this.board.getb(a.bx+b.bx>>1,a.by+b.by>>1);-3===this.inputData&&(this.inputData=1===c.qsub?-5:-4),c.isnull||(c.setQsub(-4===this.inputData?1:0),c.draw())}this.mouseCell=a}}},KeyEvent:{enablemake:!0,enableplay:!0,moveTarget:function(a){return this.puzzle.playmode&&(this.isCTRL||this.isX||this.isZ)?this.move_fillomino(a):this.moveTCell(a)},move_fillomino:function(a){var b=this.cursor.getc();if(b.isnull)return!1;var c,d,e=b.adjacent,f=b.adjborder,g=b.NDIR;switch(a){case"up":c=e.top,d=f.top,g=b.UP;break;case"down":c=e.bottom,d=f.bottom,g=b.DN;break;case"left":c=e.left,d=f.left,g=b.LT;break;case"right":c=e.right,d=f.right,g=b.RT;break;default:return!1}if(!c.isnull){var h=this.isCTRL||this.isX||this.isZ;return h?(this.isCTRL?d.isnull||(d.setQsub(0===d.qsub?1:0),this.cursor.setaddr(c)):this.isZ?d.isnull||d.setQans(d.isBorder()?0:1):this.isX&&(c.isnull||(c.setAnum(b.getNum()),this.cursor.setaddr(c))),b.draw(),this.stopEvent(),!0):!1}return!1}},Board:{hasborder:1},AreaRoomGraph:{enabled:!0,isedgevalidbylinkobj:function(a){return a.isBorder()?!1:a.sidecell[0].getNum()===a.sidecell[1].getNum()},isedgevalidbynodeobj:function(a,b){return this.board.getb(a.bx+b.bx>>1,a.by+b.by>>1).isBorder()?!1:a.getNum()===b.getNum()},setExtraData:function(a){for(var b=a.clist=new this.klass.CellList(a.getnodeobjs()),c=0,d=[],e=0,f=-1,g=0;g<b.length;g++){var h=b[g].getNum();-1===h?c++:isNaN(d[h])?(e++,f=h,d[h]=1):d[h]++}a.number=1===e?f:-1}},Graphic:{gridcolor_type:"DLIGHT",bordercolor_func:"qans",paint:function(){this.drawBGCells(),this.drawDashedGrid(),this.drawNumbers(),this.drawBorders(),this.drawBorderQsubs(),this.drawChassis(),this.drawCursor()}},Encode:{decodePzpr:function(a){this.decodeNumber16()},encodePzpr:function(a){this.encodeNumber16()},decodeKanpen:function(){this.puzzle.fio.decodeCellQnum_kanpen()},encodeKanpen:function(){this.puzzle.fio.encodeCellQnum_kanpen()}},FileIO:{decodeData:function(){this.decodeCellQnum(),this.decodeCellAnumsub(),this.decodeBorderAns()},encodeData:function(){this.encodeCellQnum(),this.encodeCellAnumsub(),this.encodeBorderAns()},kanpenOpen:function(){this.decodeCellQnum_kanpen(),this.decodeCellAnum_kanpen(),this.inputBorderFromNumber()},kanpenSave:function(){this.encodeCellQnum_kanpen(),this.encodeCellAnum_kanpen()},inputBorderFromNumber:function(){for(var a=this.board,b=0;b<a.border.length;b++){var c=a.border[b],d=c.sidecell[0],e=c.sidecell[1];if(c.qans=0,!d.isnull&&!e.isnull){var f=d.getNum(),g=e.getNum();-1!==f&&-1!==g&&f!==g&&(c.qans=1)}}},kanpenOpenXML:function(){this.decodeCellQnum_XMLBoard(),this.decodeCellAnum_XMLAnswer(),this.inputBorderFromNumber()},kanpenSaveXML:function(){this.encodeCellQnum_XMLBoard(),this.encodeCellAnum_XMLAnswer()},UNDECIDED_NUM_XML:0},AnsCheck:{checklist:["checkLargeArea","checkSideAreaNumberSize","checkSmallArea","checkNoNumCell+"],checkSideAreaNumberSize:function(){this.checkSideAreaSize(function(a){return a.number},"bsSameNum")},checkSmallArea:function(){this.checkAllErrorRoom(function(a){return!(a.number>a.clist.length)},"bkSizeLt")},checkLargeArea:function(){this.checkAllErrorRoom(function(a){return!(a.number<a.clist.length&&a.number>0)},"bkSizeGt")},checkAllErrorRoom:function(a,b){for(var c=this.board.roommgr.components,d=0;d<c.length;d++){var e=c[d];if(e&&!a(e)){if(this.failcode.add(b),this.checkOnly)break;e.clist.seterr(1)}}}},FailCode:{bkSizeLt:["ブロックの大きさより数字のほうが大きいです。","A number is bigger than the size of block."],bkSizeGt:["ブロックの大きさよりも数字が小さいです。","A number is smaller than the size of block."],bsSameNum:["同じ数字のブロックが辺を共有しています。","Adjacent blocks have the same number."]}});